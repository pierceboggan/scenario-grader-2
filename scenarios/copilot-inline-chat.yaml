id: copilot-inline-chat
name: "Refactor Code with Inline Chat"
owner: "@copilot-team"
tags: [copilot, inline-chat, refactoring]
priority: P0

description: >
  A user selects some code and uses inline chat (Cmd+I) to ask 
  Copilot to add TypeScript types. Captures the flow of selecting,
  prompting, reviewing, and accepting changes.

environment:
  vscodeTarget: desktop
  vscodeVersion: stable
  platform: macOS
  copilotChannel: stable

preconditions:
  - "VS Code installed with GitHub Copilot extension"
  - "User authenticated to GitHub Copilot"

steps:
  - id: create_file
    description: "Create a new file with sample code"
    action: createFile
    args:
      content: |
        function add(a, b) {
          return a + b;
        }
        
        function subtract(a, b) {
          return a - b;
        }
    timeout: 3000

  - id: select_all
    description: "Select all code"
    action: selectAll
    timeout: 1000

  - id: open_inline_chat
    description: "Open inline chat"
    action: openInlineChat
    hints:
      - type: keyboard
        keys: ["cmd+i"]
    timeout: 3000

  - id: ask_for_types
    description: "Ask to add TypeScript types"
    action: typeText
    args:
      text: "Add TypeScript types to these functions"
    timeout: 2000

  - id: submit
    description: "Submit the request"
    action: pressKey
    args:
      key: Enter
    timeout: 10000

  - id: review_changes
    description: "Review the suggested changes"
    action: wait
    args:
      duration: 3000

  - id: accept
    description: "Accept the changes"
    action: pressKey
    args:
      key: Enter
    timeout: 2000

observations:
  - id: diff_visibility
    question: "Are the proposed changes shown as a clear diff?"
    category: clarity
  - id: accept_reject_options
    question: "Are Accept/Reject options easily discoverable?"
    category: usability
  - id: partial_accept
    question: "Can the user accept only some of the changes?"
    category: usability
  - id: undo_available
    question: "Is it easy to undo if the user changes their mind?"
    category: friction

outputs:
  captureVideo: true
  screenshots:
    - atStep: open_inline_chat
      name: "inline-chat-opened"
    - atStep: review_changes
      name: "changes-proposed"
    - atStep: accept
      name: "changes-accepted"
  storeLogs: true
